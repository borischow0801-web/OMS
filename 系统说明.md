# 信息化软件项目运维管理系统 - 系统说明

## 系统概述

本系统是一个信息化软件项目运维管理系统，支持使用方、管理方、承建方三类用户协同工作，实现问题反馈、需求管理、任务指派、流程审核等功能。

## 功能模块

### 1. 用户管理
- 支持四种角色：使用方、管理方、承建方-项目经理、承建方-员工
- 用户注册、登录、权限管理
- 个人信息管理

### 2. 任务管理
- **使用方功能**:
  - 创建问题或需求任务
  - 查看自己创建的任务
  - 确认任务完成情况
  
- **管理方功能**:
  - 审核使用方提交的任务
  - 审核通过后提交给承建方
  - 审核不通过可直接结单
  
- **承建方-项目经理功能**:
  - 查看已审核通过的任务
  - 分析任务并指派给员工
  - 跟进任务处理进度
  
- **承建方-员工功能**:
  - 查看指派给自己的任务
  - 处理任务并提交完成
  - 跟进使用方确认情况

### 3. 工作流管理
- 任务状态流转：待审核 → 已审核 → 已指派 → 处理中 → 已完成 → 已确认 → 已结单
- 工作流日志记录
- 通知消息推送

### 4. 评论沟通
- 任务评论功能
- 实时沟通交流

## 技术架构

### 后端
- **框架**: Django 4.2 + Django REST Framework
- **认证**: JWT (Simple JWT)
- **数据库**: MySQL
- **缓存**: Redis
- **API设计**: RESTful API

### 前端PC端
- **框架**: React 18
- **UI库**: Ant Design 5
- **构建工具**: Vite
- **状态管理**: Zustand
- **路由**: React Router

### 前端移动端
- **平台**: 微信小程序
- **UI库**: Vant Weapp（可扩展）
- **开发工具**: 微信开发者工具

### 部署
- **服务器**: ubuntu 24 
- **Web服务器**: Nginx
- **容器化**: Docker (可选)

## 项目结构

```
OMS/
├── backend/                 # 后端服务
│   ├── oms_backend/         # Django项目配置
│   ├── apps/                # 应用模块
│   │   ├── accounts/        # 用户账户管理
│   │   ├── tasks/          # 任务管理
│   │   └── workflow/       # 工作流管理
│   ├── manage.py
│   └── requirements.txt
├── frontend-pc/             # PC端前端
│   ├── src/
│   │   ├── components/     # 组件
│   │   ├── pages/          # 页面
│   │   ├── api/            # API调用
│   │   ├── store/          # 状态管理
│   │   └── utils/          # 工具函数
│   └── package.json
├── frontend-miniprogram/    # 微信小程序
│   ├── pages/              # 页面
│   ├── utils/              # 工具函数
│   └── app.js             # 小程序入口
├── docs/                   # 文档
├── scripts/                # 部署脚本
└── README.md
```

## 快速开始

访问 http://localhost:3000

### 微信小程序

使用微信开发者工具打开 `frontend-miniprogram` 目录，配置AppID后即可预览。

## API接口说明

### 认证接口
- `POST /api/auth/login/` - 登录
- `POST /api/auth/refresh/` - 刷新Token

### 用户接口
- `GET /api/accounts/users/` - 获取用户列表
- `GET /api/accounts/users/me/` - 获取当前用户信息
- `POST /api/accounts/users/` - 创建用户（管理员）
- `PATCH /api/accounts/users/{id}/` - 更新用户
- `POST /api/accounts/users/change_password/` - 修改密码

### 任务接口
- `GET /api/tasks/tasks/` - 获取任务列表
- `GET /api/tasks/tasks/{id}/` - 获取任务详情
- `POST /api/tasks/tasks/` - 创建任务（使用方）
- `POST /api/tasks/tasks/{id}/review/` - 审核任务（管理方）
- `POST /api/tasks/tasks/{id}/assign/` - 指派任务（项目经理）
- `POST /api/tasks/tasks/{id}/handle/` - 处理任务（员工）
- `POST /api/tasks/tasks/{id}/confirm/` - 确认任务（使用方）
- `POST /api/tasks/tasks/{id}/add_comment/` - 添加评论

### 工作流接口
- `GET /api/workflow/logs/` - 获取工作流日志
- `GET /api/workflow/notifications/` - 获取通知列表
- `POST /api/workflow/notifications/{id}/mark_read/` - 标记通知已读

## 数据库模型

### User (用户)
- 基本信息：username, email, role, phone, department
- 角色：user(使用方), admin(管理方), manager(项目经理), employee(员工)

### Task (任务)
- 基本信息：title, description, task_type, status, priority
- 关联用户：creator, reviewer, assignee, handler
- 流程信息：review_comment, assign_comment, handle_comment, confirm_comment
- 时间戳：created_at, updated_at, closed_at

### WorkflowLog (工作流日志)
- 记录任务状态变更历史

### Notification (通知)
- 系统通知消息

## 权限说明

- **使用方**: 只能创建和查看自己的任务，确认任务完成
- **管理方**: 可以审核所有待审核任务，查看审核历史
- **项目经理**: 可以查看已审核任务，指派给员工
- **员工**: 只能查看和处理指派给自己的任务

## 部署说明

详见 `docs/部署说明.md`

## 注意事项

1. 首次部署需要创建数据库并执行迁移
2. 需要配置.env文件中的数据库连接信息
3. 生产环境建议使用gunicorn + nginx部署
4. 微信小程序需要配置合法域名
5. 建议使用HTTPS确保数据传输安全

## 后续扩展

系统预留了扩展接口，支持：
- 数据统计分析
- 硬件实时监控
- 更多工作流节点
- 文件上传下载
- 消息推送等

